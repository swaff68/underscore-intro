var parkingLot={rows:4,cols:2,slots:[{owner:"Bill",color:"blue",locked:!1,time:new Date("2013-06-06 08:00:00")},{owner:"Jake",color:"red",locked:!0,time:new Date("2013-06-05 09:00:00")},{owner:"Jill",color:"blue",locked:!0,time:new Date("2013-06-06 08:00:00")},null,{owner:"Russel",color:"skyblue",locked:!0,time:new Date("2013-06-023 09:00:00")},{owner:"Amber",color:"blue",locked:!0,time:new Date("2013-06-06 08:00:00")},null,null]},bikes=_.compact(parkingLot.slots),bikeColor=_.sortBy(bikes,function(o){return o.color+o.time.getTime()+o.owner});console.log(bikeColor);var getBikeByOwner=function(o,e){for(var r=0;r<o.slots.length;r++){var l=o.slots[r];if(l&&l.owner===e)return l}return null},createParkingLot=function(o){for(var e=$('<table class="parking-lot">'),r=0;r<o.rows;r++){var l=$("<tr>");e.append(l);for(var a=0;a<o.cols;a++){var s=r*o.cols+a,t=$("<td>");if(l.append(t),o.slots[s]){t.attr("data-owner",o.slots[s].owner),t.append('<span class="bike">o-}o</span>'),t.css("color",o.slots[s].color||"black");var c=$('<a href="#" class="swatch">').css("background-color","black"),n=$('<a href="#" class="swatch">').css("background-color","red"),i=$('<a href="#" class="swatch">').css("background-color","skyblue"),k=$('<a href="#" class="swatch">').css("background-color","gold");t.append(c,n,i,k)}}}return e};$(document).on("ready",function(){$(document).on("click",".swatch",function(o){o.preventDefault();var e=$(this).css("background-color"),r=$(this).closest("td");r.css("color",e);var l=r.attr("data-owner"),a=getBikeByOwner(parkingLot,l);a.color=e});var o=createParkingLot(parkingLot);$("body").append(o)});